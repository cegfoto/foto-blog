<!DOCTYPE html>
<html>
<head>
  <title>Game</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>

    <!-- Header -->
    <header class="w3-container w3-xlarge w3-padding-24 ">
      <div class="w3-bar w3-white w3-wide w3-padding" >
        Jogo da Memória
        <a href="#about" class="w3-right w3-button w3-white">Bancos de Imagens</a>
      </div> 
    </header>

    <div class="w3-row-padding">
      <div class="w3-col l3 m6 w3-margin-bottom">
          Jogadas: <p id="play-counter"></p>
      </div>
      <div class="w3-col l3 m6 w3-margin-bottom">
          Acertos: <p id="hit-counter"></p>
      </div>        
    </div>

    <div class="w3-row-padding">
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">1</div>
            <img class="real-image" id="1" src="1-1.JPG" style="width:99%; display: none;">
            <img onclick="showImage(1)" id="1-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">2</div>
            <img class="real-image"  id="2" src="1-1.JPG"  style="width:99%; display: none;">
            <img onclick="showImage(2)" id="2-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">3</div>
            <img class="real-image" id="3" src="1-1.JPG"  style="width:99%; display: none;">
            <img onclick="showImage(3)" id="3-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">4</div>
            <img class="real-image" id="4" src="1-1.JPG"  style="width:99%; display: none;">
            <img onclick="showImage(4)" id="4-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>
    </div>

    <div class="w3-row-padding">
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">5</div>
            <img class="real-image" id="5" src="1-1.JPG"  style="width:99%; display: none;">
            <img onclick="showImage(5)" id="5-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">6</div>
            <img class="real-image" id="6" src="1-1.JPG"  style="width:99%; display: none;">
            <img onclick="showImage(6)" id="6-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">7</div>
            <img class="real-image" id="7" src="1-1.JPG"  style="width:99%; display: none;">
            <img onclick="showImage(7)" id="7-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>
        <div class="w3-col l3 m6 w3-margin-bottom">
          <div class="w3-display-container">
            <div class="w3-display-topleft w3-black w3-padding">8</div>
            <img class="real-image" id="8" src="1-1.JPG"  style="width:99%; display: none;">
            <img onclick="showImage(8)" id="8-cover" class="cover-image" src="0-0.JPG" style="width:99%">
          </div>
        </div>

        <div class="w3-row-padding">
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">9</div>
                <img class="real-image" id="9" src="1-1.JPG"  style="width:99%; display: none;">
                <img onclick="showImage(9)" id="9-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
            </div>
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">10</div>
                <img class="real-image" id="10" src="1-1.JPG"  style="width:99%; display: none;">
                <img onclick="showImage(10)" id="10-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
            </div>
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">11</div>
                <img class="real-image" id="11" src="1-1.JPG"  style="width:99%; display: none;">
                <img onclick="showImage(11)" id="11-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
            </div>
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">12</div>
                <img class="real-image" id="12" src="1-1.JPG"  style="width:99%; display: none;">
                <img onclick="showImage(12)" id="12-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
        </div>

        <div class="w3-row-padding">
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">13</div>
                <img class="real-image" id="13" src="1-1.JPG" style="width:99%; display: none;">
                <img onclick="showImage(13)" id="13-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
            </div>
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">14</div>
                <img class="real-image" id="14" src="1-1.JPG"  style="width:99%; display: none;">
                <img onclick="showImage(14)" id="14-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
            </div>
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">15</div>
                <img class="real-image" id="15"  src="1-1.JPG"  style="width:99%; display: none;">
                <img onclick="showImage(15)" id="15-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
            </div>
            <div class="w3-col l3 m6 w3-margin-bottom">
              <div class="w3-display-container">
                <div class="w3-display-topleft w3-black w3-padding">16</div>
                <img class="real-image" id="16" src="1-1.JPG"  style="width:99%; display: none;">
                <img onclick="showImage(16)" id="16-cover" class="cover-image" src="0-0.JPG" style="width:99%">
              </div>
        </div>

    </div>
    <footer class="w3-light-grey w3-padding-64 w3-center" id="about">
      <h2>Bancos de Imagens</h2>
      <a target="_blank" href="https://www.shutterstock.com/pt/g/Maursk8"><i class="fa fa-shopping-bag w3-hover-opacity" style='font-size:48px;'></i></a>
      <a target="_blank" href="https://stock.adobe.com/br/contributor/209738965/Mauri"><i class="fa fa-shopping-bag w3-hover-opacity" style='font-size:48px;'></i></a>
      <h2>Mídias Sociais</h2>
      <a target="_blank" href="https://www.instagram.com/fotosvisoes/"><i class="fa fa-instagram w3-hover-opacity" style='font-size:48px;'></i></a>
    </footer>

    <script>
        let indexesAlreadyUsed = [];
        let count = 0;
        let currentPlay = [];
        let hits = 0;
        let plays = 0;

        let notBreak = 0;
        while (indexesAlreadyUsed.length < 8) {
          let indexImageOne = Math.floor(Math.random() * (4 - 1 + 1)) + 1;
          let indiceImagemDois = Math.floor(Math.random() * (4 - 1 + 1)) + 1;
          let image = indexImageOne + '-' + indiceImagemDois;

          if (indexesAlreadyUsed.indexOf(image) == -1) {
            indexesAlreadyUsed.push(image);
          }
          if (notBreak >= 100) {
            break;
          }
          notBreak++;
        }

        let usedPositions = [];
        notBreak = 0;
        while (usedPositions.length < 16) {
          let position = Math.floor(Math.random() * (16 - 1 + 1)) + 1;
          if (usedPositions.indexOf(position) == -1) {
            usedPositions.push(position);
          }

          if (notBreak >= 100) {
            break;
          }
          notBreak++;
        }

        if (
          usedPositions.length < 16
          || indexesAlreadyUsed.length < 8
        ) {
          alert('Unable to mount game, page will be reloaded.');
          location.reload()
        }

        let memory = [];
        for (count = 0; count < 8; count++) {
          memory.push(
            [
              indexesAlreadyUsed[count],
              usedPositions[count],
              usedPositions[count+8]
            ]
          );
        }
      
        for (count = 0; count < 8; count++) {
          document.getElementById(memory[count][1]).src = memory[count][0] + '.JPG';
          document.getElementById(memory[count][2]).src = memory[count][0] + '.JPG';
        }

        let coverImages = document.getElementsByClassName("cover-image");
        let realImages =  document.getElementsByClassName("real-image");
        for (let i = 0; i < coverImages.length; i++) {
          coverImages[i].style.display = 'none';
          realImages[i].style.display = '';
        }
        setTimeout(initialSampling, 5000);

        function showImage(image) {
          if (currentPlay.length >= 2) {
            return;
          }

          document.getElementById(image + "-cover").style.display = 'none';
          document.getElementById(image).style.display = '';

          currentPlay.push([ 
            document.getElementById(image).src,
            image
          ]);

          if (currentPlay.length >= 2) {
            if (currentPlay[0][0] == currentPlay[1][0]) {
              hits++;
              currentPlay = [];
            } else {
              setTimeout(esconderImagem, 1000);
            }
            plays++;
          }

          document.getElementById('play-counter').textContent = plays;
          document.getElementById('hit-counter').textContent = hits;

          if (hits >= 8) {
            alert('Game Over!! ' + plays + ' Jogadas');
          }
        }

        function esconderImagem() {
          document.getElementById(currentPlay[0][1] + "-cover").style.display = '';
          document.getElementById(currentPlay[0][1]).style.display = 'none';
          document.getElementById(currentPlay[1][1] + "-cover").style.display = '';
          document.getElementById(currentPlay[1][1]).style.display = 'none';
          currentPlay = [];
        }

        function initialSampling() {
          let coverImages = document.getElementsByClassName("cover-image");
          let realImages =  document.getElementsByClassName("real-image");

          for (let i = 0; i < coverImages.length; i++) {
            coverImages[i].style.display = '';
            realImages[i].style.display = 'none';
          }
        }
    </script>

</body>
</html>